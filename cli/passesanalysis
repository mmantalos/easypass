import argparse
import requests
import json
import pandas as pd

parser  = argparse.ArgumentParser(prog = "passesanalysis",
                                 description = "Get passes of vehicles with different tag provider than station provider.")
#define command arguments
parser.add_argument("--op1", required = True)
parser.add_argument("--op2", required = True)
parser.add_argument("--datefrom", required = True)
parser.add_argument("--dateto", required = True)
parser.add_argument("--format", choices = ["json", "csv"], required = True)
#parse command line input
args = parser.parse_args()

#for now doesn't verify SSL ->fix https
res = requests.get(f"http://localhost:9103/interoperability/api/PassesAnalysis/{args.op1}/{args.op2}/{args.datefrom}/{args.dateto}?format={args.format}", verify = False)
if(args.format == 'csv'): #is this the correct format?
    decoded_content = res.content.decode('utf-8')
    print(res.content.decode('utf-8'))
else:
    print(json.dumps(res.json(), indent=4))
